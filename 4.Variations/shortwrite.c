#include <stdio.h>
#include <string.h>

void shortwrite()
{
	unsigned char canary[5];
	unsigned char foo[4];

	memset(foo, '\x00', sizeof(foo));
	strcpy(canary, "AAAA");

	printf("%8208u%hn%24624u%hn",
			 1, (int *)&foo[0],
			 1, (int *)&foo[2]);

	printf("\nfoo: %02x%02x%02x%02x\n", foo[0], foo[1], foo[2], foo[3]);
	printf("canary: %02x%02x%02x%02x\n", canary[0], canary[1], canary[2], canary[3]);
}

int main(int argv, char* argc[])
{
	shortwrite();
	return 0;
}